# -*- coding: utf-8 -*-
"""Fitness_chatbot_projem.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/198y3gJzAQ6IuGHOyXwr0fTTMAE7Iv2QF
"""

# HÃœCRE 1: En gÃ¼ncel ve uyumlu kÃ¼tÃ¼phaneleri kurma
!pip install -U langchain langchain-core langchain-community langchain-google-genai -q
!pip install chromadb sentence-transformers langchain-text-splitters -q
print("TÃ¼m kÃ¼tÃ¼phaneler gÃ¼ncel ve uyumlu bir ÅŸekilde kuruldu.")

# Python Path'i dÃ¼zeltme (Ã¶nceki denemelerdeki kritik dÃ¼zeltme)
import sys
import site

forced_path = '/usr/local/lib/python3.10/dist-packages'
if forced_path not in sys.path:
    sys.path.append(forced_path)
    print(f"Python arama yolu dÃ¼zeltildi: {forced_path}")

print("Kurulum ve Python arama yolu dÃ¼zeltmesi tamamlandÄ±. HÃœCRE 2'ye geÃ§in.")

# HÃœCRE 2: API AnahtarÄ±nÄ± Ayarlama
from google.colab import userdata
import os

# NOT: LÃ¼tfen API anahtarÄ±nÄ±zÄ±n Colab Secrets'ta 'GEMINI_API_KEY' adÄ±yla kayÄ±tlÄ± olduÄŸundan emin olun.
GEMINI_API_KEY = userdata.get('GEMINI_API_KEY')
os.environ['GEMINI_API_KEY'] = GEMINI_API_KEY

print("API AnahtarÄ± baÅŸarÄ±yla ayarlandÄ±.")

# HÃœCRE 3: Veri Setini OluÅŸturma
from langchain_google_genai import ChatGoogleGenerativeAI
from google.colab import userdata

GEMINI_API_KEY = userdata.get('GEMINI_API_KEY')
llm = ChatGoogleGenerativeAI(model="gemini-2.5-flash", temperature=0.3, api_key=GEMINI_API_KEY)

prompt_text = """
Fitness ve vÃ¼cut geliÅŸtirme Ã¼zerine kapsamlÄ± bir veri seti oluÅŸtur.
AÅŸaÄŸÄ±daki her egzersiz iÃ§in: Bench Press, Deadlift, Squat, Overhead Press, Barbell Row, Pull-up, Lunge.
Her egzersiz iÃ§in: AdÄ±, NasÄ±l YapÄ±lÄ±r, Temel Kas GruplarÄ±, Ã–nemli Ä°pucu bilgilerini iÃ§ermeli.
CevabÄ±n sadece dÃ¼z metin olsun.
"""

print("Veri seti oluÅŸturuluyor...")
response = llm.invoke(prompt_text)
data = response.content

with open("egzersiz_veri.txt", "w", encoding="utf-8") as f:
    f.write(data)

print("Veri seti (egzersiz_veri.txt) baÅŸarÄ±yla oluÅŸturuldu ve kaydedildi.")

# YENÄ° HÃœCRE: TÃ¼m Veri Setini (Eski + Yeni) Kodla Yeniden Yazma

tum_veri_seti = """
KONU: Deadlift
YapÄ±lÄ±ÅŸÄ±:
1. AyaklarÄ±nÄ±zÄ± omuz geniÅŸliÄŸinde aÃ§Ä±n ve barÄ± ayaklarÄ±nÄ±za yakÄ±n tutun.
2. KalÃ§anÄ±zÄ± geriye itin ve sÄ±rtÄ±nÄ±zÄ± dÃ¼z tutarak barÄ± kavrayÄ±n.
3. GÃ¶ÄŸsÃ¼nÃ¼zÃ¼ yukarÄ± kaldÄ±rÄ±n, nefes alÄ±n ve bacaklarÄ±nÄ±zla yeri itin.
4. BarÄ± bacaklarÄ±nÄ±za yakÄ±n tutarak yukarÄ± kalkÄ±n.
Ã‡alÄ±ÅŸan Kaslar: Arka zincir (Hamstring, KalÃ§a, Alt SÄ±rt), Trapez, Ã–n Kol.
Ä°pucu: Hareketi bacaklarÄ±nÄ±zla baÅŸlatÄ±n, sÄ±rtÄ±nÄ±zÄ± kilit pozisyonuna getirin. BarÄ± her zaman vÃ¼cuda yakÄ±n tutun.

KONU: Squat
YapÄ±lÄ±ÅŸÄ±:
1. BarÄ± trapez kaslarÄ±nÄ±zÄ±n Ã¼zerine rahatÃ§a yerleÅŸtirin.
2. AyaklarÄ±nÄ±zÄ± omuz geniÅŸliÄŸinden biraz daha fazla aÃ§Ä±n.
3. Harekete kalÃ§anÄ±zÄ± geriye doÄŸru iterek baÅŸlayÄ±n. Dizleriniz ayak parmaklarÄ±nÄ±zla aynÄ± hizada olmalÄ±.
4. KalÃ§anÄ±z dizlerinizin altÄ±na inene kadar inin (derinlik esneklik limitiniz kadardÄ±r).
Ã‡alÄ±ÅŸan Kaslar: Quadriceps (Ã–n Bacak), Hamstring, KalÃ§a.
Ä°pucu: Yere sÄ±kÄ±ca basarak dengenizi koruyun. AÄŸÄ±rlÄ±ÄŸÄ± merkeze odaklayÄ±n ve dizlerinizi dÄ±ÅŸarÄ± itin.

KONU: Bench Press
YapÄ±lÄ±ÅŸÄ±:
1. Sehpaya yatÄ±n, gÃ¶z hizasÄ±na barÄ± getirin. KÃ¼rek kemiklerinizi birbirine doÄŸru sÄ±kÄ±ÅŸtÄ±rÄ±n.
2. BarÄ± omuz geniÅŸliÄŸinden biraz daha aÃ§Ä±k bir tutuÅŸla kavrayÄ±n.
3. BarÄ± yavaÅŸÃ§a gÃ¶ÄŸsÃ¼nÃ¼zÃ¼n alt kÄ±smÄ±na indirin. Dirsekleriniz vÃ¼cudunuza 45-75 derece aÃ§Ä±yla bakmalÄ±.
4. KontrollÃ¼ bir ÅŸekilde barÄ± yukarÄ± itin.
Ã‡alÄ±ÅŸan Kaslar: Pektoral (GÃ¶ÄŸÃ¼s), Ã–n Omuz, Triceps (Arka Kol).
Ä°pucu: KÃ¼rek kemiklerini sehpaya kilitlemek ve ayaklarÄ± yere sÄ±kÄ±ca basmak kuvvet aktarÄ±mÄ±nÄ± artÄ±rÄ±r.

KONU: Barbell Row
YapÄ±lÄ±ÅŸÄ±:
1. AyaklarÄ± omuz geniÅŸliÄŸinde aÃ§Ä±n ve barÄ± diz hizasÄ±na kadar kaldÄ±rÄ±n.
2. Dizleri hafif kÄ±rÄ±n, gÃ¶vdeyi 45 derece Ã¶ne eÄŸin ve sÄ±rtÄ±nÄ±zÄ± dÃ¼z tutun.
3. BarÄ± gÃ¶beÄŸinizin alt kÄ±smÄ±na doÄŸru Ã§ekin, kÃ¼rek kemiklerinizi sÄ±kÄ±n.
4. YavaÅŸÃ§a baÅŸlangÄ±Ã§ pozisyonuna dÃ¶nÃ¼n.
Ã‡alÄ±ÅŸan Kaslar: Latissimus Dorsi (SÄ±rtÄ±n GeniÅŸ KaslarÄ±), Trapez, Biceps (Ã–n Kol).
Ä°pucu: Ã‡ekiÅŸ sÄ±rasÄ±nda dirseklerinizi vÃ¼cudunuza yakÄ±n tutun ve sÄ±rt kaslarÄ±nÄ±zla Ã§ekmeyi odaklayÄ±n.

KONU: Overhead Press (Omuz Pres)
YapÄ±lÄ±ÅŸÄ±:
1. Ayakta veya oturarak, barÄ± omuz hizasÄ±nda tutun (Ã¶n omuzlarÄ±n hemen Ã¼stÃ¼nde).
2. BarÄ± baÅŸÄ±nÄ±zÄ±n Ã¼zerinden yukarÄ± doÄŸru itin, kollarÄ±nÄ±zÄ± tam aÃ§Ä±n.
3. BarÄ± yavaÅŸÃ§a baÅŸlangÄ±Ã§ pozisyonuna indirin.
Ã‡alÄ±ÅŸan Kaslar: Deltoidler (Omuz kaslarÄ±), Triceps.
Ä°pucu: VÃ¼cudun merkez bÃ¶lgesini (core) sÄ±kÄ± tutmak, sÄ±rtÄ±n geriye eÄŸilmesini (bel Ã§ukurunun artmasÄ±nÄ±) engeller.

KONU: Lunge
YapÄ±lÄ±ÅŸÄ±:
1. Ayakta dik durun ve bir adÄ±m Ã¶ne atÄ±n.
2. GÃ¶vdenizi dik tutarak kalÃ§anÄ±zÄ± aÅŸaÄŸÄ± indirin. Ã–n diziniz 90 derece bÃ¼kÃ¼lmeli ve ayak parmaklarÄ±nÄ±zÄ± geÃ§memeli. Arka diziniz yere yaklaÅŸmalÄ±.
3. Ã–n ayaÄŸÄ±nÄ±zla yeri iterek baÅŸlangÄ±Ã§ pozisyonuna dÃ¶nÃ¼n.
Ã‡alÄ±ÅŸan Kaslar: Quadriceps, Hamstring, KalÃ§a, Dengeleyici kaslar.
Ä°pucu: Dengede kalmak iÃ§in bakÄ±ÅŸÄ±nÄ±zÄ± sabit bir noktaya odaklayÄ±n. AdÄ±mlarÄ±nÄ±zÄ± Ã§ok geniÅŸ veya Ã§ok dar atmamaya dikkat edin.

KONU: Bicep Curl
YapÄ±lÄ±ÅŸÄ±:
1. Ayakta dik durun, dambÄ±llarÄ± avuÃ§ iÃ§leri yukarÄ± bakacak ÅŸekilde tutun.
2. Dirseklerinizi vÃ¼cudunuza yakÄ±n tutarak dambÄ±llarÄ± omuz hizasÄ±na kadar kaldÄ±rÄ±n. Sadece Ã¶n kol kaslarÄ±nÄ± kullanÄ±n.
3. AÄŸÄ±rlÄ±ÄŸÄ± yavaÅŸÃ§a baÅŸlangÄ±Ã§ pozisyonuna indirin.
Ã‡alÄ±ÅŸan Kaslar: Biceps.
Ä°pucu: Hareketi yavaÅŸ ve kontrollÃ¼ yapÄ±n. Dirseklerinizi sabitlemek omuzlarÄ±n devreye girmesini engeller.

--- EK BÄ°LGÄ°LER: BESLENME VE PROGRAMLAMA ---

KONU: Makro Besinler (Makrolar)
TanÄ±m: VÃ¼cudun enerji ve temel yapÄ± taÅŸlarÄ± iÃ§in en bÃ¼yÃ¼k miktarda ihtiyaÃ§ duyduÄŸu besin Ã¶geleridir. ÃœÃ§ ana makro besin ÅŸunlardÄ±r:
1. Protein: Kas onarÄ±mÄ± ve bÃ¼yÃ¼mesi iÃ§in hayati Ã¶neme sahiptir.
   - Kalori DeÄŸeri: 1 gram = 4 kalori.
   - Ä°puÃ§larÄ±: Kas kÃ¼tlesi kazanmak veya korumak iÃ§in vÃ¼cut aÄŸÄ±rlÄ±ÄŸÄ±nÄ±n kilogramÄ± baÅŸÄ±na 1.6 ila 2.2 gram tÃ¼ketilmesi Ã¶nerilir.
2. Karbonhidrat: Antrenman sÄ±rasÄ±nda ve gÃ¼nlÃ¼k yaÅŸamda vÃ¼cudun ana enerji kaynaÄŸÄ±dÄ±r.
   - Kalori DeÄŸeri: 1 gram = 4 kalori.
   - Ä°puÃ§larÄ±: YoÄŸun antrenman yapan sporcular iÃ§in toplam kalori alÄ±mÄ±nÄ±n %45-%65'ini oluÅŸturmalÄ±dÄ±r. Tam tahÄ±llar ve sebzeler tercih edilmeli.
3. YaÄŸlar (Lipitler): Hormon Ã¼retimi, organ korumasÄ± ve yaÄŸda Ã§Ã¶zÃ¼nen vitaminlerin emilimi iÃ§in gereklidir.
   - Kalori DeÄŸeri: 1 gram = 9 kalori.
   - Ä°puÃ§larÄ±: Diyetin %20-%35'ini oluÅŸturmalÄ±. SaÄŸlÄ±klÄ± yaÄŸ kaynaklarÄ± (avokado, fÄ±ndÄ±k, zeytinyaÄŸÄ±) tercih edilmeli.

KONU: Supplementler (Takviyeler)
En PopÃ¼ler Takviyeler:
1. Kreatin: Kas gÃ¼cÃ¼nÃ¼ ve yÃ¼ksek yoÄŸunluklu egzersiz performansÄ±nÄ± artÄ±rdÄ±ÄŸÄ± bilimsel olarak kanÄ±tlanmÄ±ÅŸ en etkili takviyedir.
   - KullanÄ±m: Genellikle gÃ¼nlÃ¼k 3-5 gram Ã¶nerilir.
2. Whey Protein: HÄ±zlÄ± emilen bir protein kaynaÄŸÄ±dÄ±r, Ã¶zellikle antrenman sonrasÄ± kas onarÄ±mÄ± iÃ§in idealdir.
3. BCAA (DallÄ± Zincirli Amino Asitler): YoÄŸun antrenman sÄ±rasÄ±nda kas yÄ±kÄ±mÄ±nÄ± Ã¶nlemeye yardÄ±mcÄ± olabilir.
   - Not: Yeterli protein alÄ±mÄ± varsa, BCAA Ã§oÄŸu zaman gereksizdir.

KONU: Antrenman ProgramÄ± TÃ¼rleri (Split)
1. Full Body (TÃ¼m VÃ¼cut): Her seansta tÃ¼m ana kas gruplarÄ±nÄ± Ã§alÄ±ÅŸtÄ±rÄ±r.
   - Kimler Ä°Ã§in Ä°deal: Yeni baÅŸlayanlar ve haftada 2-3 gÃ¼n antrenman yapanlar. Kas iyileÅŸmesine yeterli zaman tanÄ±r.
2. Push/Pull/Legs (PPL): Ä°tme, Ã§ekme ve bacak hareketlerini farklÄ± gÃ¼nlerde gruplar.
   - TanÄ±m: Push (gÃ¶ÄŸÃ¼s, omuz, tricep), Pull (sÄ±rt, biceps), Legs (bacaklar).
   - Kimler Ä°Ã§in Ä°deal: Haftada 4-6 gÃ¼n antrenman yapan, daha ileri dÃ¼zey sporcular.
3. Bro Split (VÃ¼cut BÃ¶lgesi Split): Her gÃ¼n sadece bir veya iki kas grubunu Ã§alÄ±ÅŸtÄ±rÄ±r (Ã¶rn: Pazartesi GÃ¶ÄŸÃ¼s, SalÄ± Bacak).
   - Kimler Ä°Ã§in Ä°deal: Geleneksel vÃ¼cut geliÅŸtirme tarzÄ±nÄ± sevenler; her kas grubunu haftada bir kez Ã§ok yÃ¼ksek hacimle yormak.
"""

# DosyayÄ± "yazma" modu ('w') ile aÃ§arak eski iÃ§eriÄŸi siler ve yenisini yazar.
try:
    with open('egzersiz_veri.txt', 'w', encoding='utf-8') as f:
        f.write(tum_veri_seti)
    print("âœ… TÃœM VERÄ° SETÄ° BAÅARIYLA YENÄ°DEN OLUÅTURULDU.")

except Exception as e:
    print(f"KRÄ°TÄ°K HATA: Dosya yazma iÅŸlemi sÄ±rasÄ±nda bir sorun oluÅŸtu: {e}")

# HÃœCRE 4: Veriyi ParÃ§alama
from langchain_text_splitters import RecursiveCharacterTextSplitter
from langchain_community.document_loaders import TextLoader

loader = TextLoader("egzersiz_veri.txt", encoding="utf-8")
documents = loader.load()

text_splitter = RecursiveCharacterTextSplitter(
    chunk_size=1500, chunk_overlap=200, length_function=len
)
chunks = text_splitter.split_documents(documents)

print(f"OluÅŸturulan ParÃ§a SayÄ±sÄ± (Chunks): {len(chunks)}")
print("BaÅŸarÄ±lÄ±: chunks listesi oluÅŸturuldu.")

# HÃœCRE 5: VektÃ¶rleÅŸtirme
from langchain_community.vectorstores import Chroma
from langchain_community.embeddings import HuggingFaceEmbeddings

print("--- YEREL EMBEDDING MODELÄ° KULLANILIYOR ---")
embeddings = HuggingFaceEmbeddings(model_name="all-MiniLM-L6-v2")

print("\nVeri parÃ§alarÄ± vektÃ¶rleÅŸtiriliyor...")
vectorstore = Chroma.from_documents(
    documents=chunks,
    embedding=embeddings,
    persist_directory="./chroma_db"
)

print("\nBAÅARILI: VektÃ¶rleÅŸtirme tamamlandÄ± ve ChromaDB'ye kaydedildi.")

# HÃœCRE 6: RAG Zinciri Kurulumu ve Test (LCEL ZORLAMA)

from langchain_google_genai import ChatGoogleGenerativeAI
from langchain_core.prompts import ChatPromptTemplate
from langchain_core.runnables import RunnablePassthrough, RunnableSequence
from langchain_core.output_parsers import StrOutputParser
from google.colab import userdata

# KRÄ°TÄ°K: create_chain fonksiyonlarÄ±nÄ± atmak iÃ§in LCEL yapÄ±sÄ±nÄ± manuel kuruyoruz.
# YALNIZCA bu importlarÄ±n Ã§alÄ±ÅŸmasÄ± iÃ§in tasarlanmÄ±ÅŸtÄ±r.

# LLM Kurulumu
GEMINI_API_KEY = userdata.get('GEMINI_API_KEY')
llm = ChatGoogleGenerativeAI(model="gemini-2.5-flash", temperature=0.1, api_key=GEMINI_API_KEY)

# Retriever Kurulumu
retriever = vectorstore.as_retriever(search_kwargs={"k": 3})

# Prompt ve Zincir OluÅŸturma (LCEL)
prompt = ChatPromptTemplate.from_template("""
AÅŸaÄŸÄ±daki baÄŸlamÄ± kullanarak soruyu cevapla.
CevabÄ±nÄ± yalnÄ±zca saÄŸlanan baÄŸlamdaki bilgilere dayandÄ±r.
BaÄŸlamda cevap yoksa, "Bu konuda veri setimde bilgi bulunmamaktadÄ±r." diye cevap ver.

BaÄŸlam: {context}

Soru: {input}
""")

# 1. DokÃ¼manlarÄ± birleÅŸtiren fonksiyon:
def format_docs(docs):
    return "\n\n".join(doc.page_content for doc in docs)

# 2. RAG Zincirini Manuel Olarak Kurma (RunnableSequence ile)
# Bu zincir:
# 1. GiriÅŸi alÄ±r.
# 2. Retriever'a gÃ¶nderir (documents'larÄ± getirir)
# 3. Prompt'u formatlar (context ve input'u doldurur)
# 4. LLM'i Ã§aÄŸÄ±rÄ±r (cevap Ã¼retir)
# 5. Ã‡Ä±ktÄ±yÄ± dÃ¼z metne Ã§evirir.

qa_chain = (
    {"context": retriever | format_docs, "input": RunnablePassthrough()}
    | prompt
    | llm
    | StrOutputParser()
)


# TEST SORGU
sorgu = "Deadlift egzersizini yaparken en Ã§ok hangi kas gruplarÄ± Ã§alÄ±ÅŸÄ±r ve bana en Ã¶nemli ipucunu ver."
print(f"Sorgu: {sorgu}\n")

print("Gemini API'den RAG tabanlÄ± cevap bekleniyor...")
# ArtÄ±k qa_chain.invoke'a sadece input gÃ¶nderilir.
cevap = qa_chain.invoke(sorgu)

print("-" * 50)
print("CEVAP:")
print(cevap) # Cevap artÄ±k doÄŸrudan string olarak geliyor
print("-" * 50)

"""Bundan sonra Web ArayÃ¼zÃ¼ iÃ§in Ã§alÄ±ÅŸacaÄŸÄ±m (b"""

# YENÄ° HÃœCRE: Gradio Kurulumu
!pip install gradio -q
print("Gradio kÃ¼tÃ¼phanesi kuruldu.")

# ModÃ¼l hatalarÄ±nÄ± aÅŸan son HÃœCRE 6 yapÄ±sÄ±nÄ± yeniden kuralÄ±m.
# (Tekrar tekrar Ã§alÄ±ÅŸtÄ±rmamak iÃ§in tÃ¼m gerekli objelerin tanÄ±mlÄ± olduÄŸunu varsayÄ±yoruz.)

from langchain_google_genai import ChatGoogleGenerativeAI
from langchain_core.prompts import ChatPromptTemplate
from langchain_core.runnables import RunnablePassthrough, RunnableSequence
from langchain_core.output_parsers import StrOutputParser
from google.colab import userdata
from langchain_core.messages import HumanMessage, AIMessage

# Gerekli objelerin tanÄ±mlÄ± olduÄŸundan emin olmak iÃ§in LLM ve Retriever'Ä± tekrar tanÄ±mlÄ±yoruz.
# (HÃœCRE 1'den HÃœCRE 5'e kadar her ÅŸeyin Ã§alÄ±ÅŸmÄ±ÅŸ olmasÄ± gerekir.)
GEMINI_API_KEY = userdata.get('GEMINI_API_KEY')
llm = ChatGoogleGenerativeAI(model="gemini-2.5-flash", temperature=0.1, api_key=GEMINI_API_KEY)
# vectorstore objesinin HÃœCRE 5'ten geldiÄŸini varsayÄ±yoruz.
retriever = vectorstore.as_retriever(search_kwargs={"k": 3})

# format_docs fonksiyonunu tanÄ±mla (LCEL iÃ§in gerekli)
def format_docs(docs):
    return "\n\n".join(doc.page_content for doc in docs)

# Prompt'u tanÄ±mla
rag_prompt = ChatPromptTemplate.from_template("""
AÅŸaÄŸÄ±daki baÄŸlamÄ± kullanarak soruyu cevapla.
CevabÄ±nÄ± yalnÄ±zca saÄŸlanan baÄŸlamdaki bilgilere dayandÄ±r.
BaÄŸlamda cevap yoksa, "Bu konuda veri setimde bilgi bulunmamaktadÄ±r." diye cevap ver.

BaÄŸlam: {context}

Soru: {input}
""")

# RAG Zincirini Kurma (HÃœCRE 6'daki en son baÅŸarÄ±lÄ± LCEL yapÄ±sÄ±)
qa_chain = (
    {"context": retriever | format_docs, "input": RunnablePassthrough()}
    | rag_prompt
    | llm
    | StrOutputParser()
)

# YENÄ° HÃœCRE: Gradio ArayÃ¼z Kodu ve Fonksiyon TanÄ±mÄ±

import gradio as gr

# Bu fonksiyon, Gradio'dan gelen mesajÄ± alÄ±r ve RAG zincirine gÃ¶nderir.
# Åu anki RAG zincirimiz tek dÃ¶nÃ¼ÅŸlÃ¼ (hafÄ±zasÄ±z) olduÄŸu iÃ§in, chat_history'yi sadece gÃ¶sterimde kullanacaÄŸÄ±z.
def rag_chat_interface(message, history):
    # History (geÃ§miÅŸ) Gradio'dan gelir, ancak RAG zincirimiz sadece son soruyu (message) kullanÄ±r.

    # RAG Zincirine gÃ¶nderme
    # qa_chain objesi, LCEL yapÄ±sÄ± gereÄŸi tek bir dictionary {"input": soru} bekler.
    response = qa_chain.invoke(message)

    # Gradio'ya cevabÄ± dÃ¶ndÃ¼rme
    return response

# Gradio ArayÃ¼z TanÄ±mÄ±
gr.ChatInterface(
    fn=rag_chat_interface,
    title="Fitness Bilgi AsistanÄ± (RAG-Gemini)",
    theme="soft",
    description="Fitness veri setinizi (Deadlift, Squat vb.) kullanarak sorularÄ±nÄ±zÄ± cevaplayan yapay zeka.",
    examples=[
        "Squat yaparken en Ã¶nemli ipucu nedir?",
        "Barbell Row egzersizinin temel kas gruplarÄ± nelerdir?",
        "Deadlift yaparken sÄ±rtÄ±mÄ± nasÄ±l korurum?",
    ]
).queue().launch(share=True)

"""Buradan sonraki hÃ¼cre readme oluÅŸturmak iÃ§indir."""

# YENÄ° HÃœCRE: README.md DosyasÄ±nÄ± KullanÄ±cÄ±nÄ±n Ä°steÄŸine GÃ¶re GÃ¼ncelleme

readme_content_kullanici = """
# Fitness Bilgi AsistanÄ± (RAG - Gemini Destekli)

Bu proje, **Retrieval Augmented Generation (RAG)** mimarisi ile
geliÅŸtirilmiÅŸ kÃ¼Ã§Ã¼k Ã§aplÄ± bir fitness chatbotudur.

## Projenin AmacÄ±

Projenin amacÄ±, veri setinde yer alan bilgilere
gÃ¶re bazÄ± egzersizler (Ã¶rnek: deadlift, squat, bench press vb.) ve beslenme hakkÄ±nda
sorulan sorularÄ± doÄŸru ve gÃ¼venilir bir ÅŸekilde cevaplamaktÄ±r.

## Ã–zellikler

* **Veri KapsamÄ±:** Beslenme ve temel egzersizler hakkÄ±nda detaylÄ± veri.
* **Yapay Zeka Modeli:** Google **Gemini API** kullanÄ±lÄ±r.
* **Mimari:** **LangChain LCEL** (Expression Language) ile oluÅŸturulmuÅŸ RAG zinciri.
* **Veri YÃ¶netimi:** **VektÃ¶rleÅŸtirme** ile veriye hÄ±zlÄ± eriÅŸim.

## Ã‡alÄ±ÅŸtÄ±rmak Ä°Ã§in

1.  **Colab not defterindeki hÃ¼creleri sÄ±rayla tek tek Ã§alÄ±ÅŸtÄ±rÄ±n.**
2.  **API AnahtarÄ± KontrolÃ¼:** EÄŸer API anahtarÄ± Ã§alÄ±ÅŸmazsa, soldaki kilit simgesine tÄ±klayÄ±n ve API anahtarÄ±nÄ±zÄ±n doÄŸru tanÄ±mlandÄ±ÄŸÄ±ndan emin olun.
3.  **ArayÃ¼ze GeÃ§iÅŸ:** TÃ¼m hÃ¼creler Ã§alÄ±ÅŸtÄ±rÄ±lÄ±nca (son aÅŸamada) Gradio arayÃ¼zÃ¼ otomatik olarak aÃ§Ä±lacaktÄ±r.
4.  **Sorgulama:** Ä°sterseniz verilen 3 Ã¶rnek sorgudan birini veya veri setinin iÃ§inde yer alacak ÅŸekilde istediÄŸiniz soruyu sorabilirsiniz.

## Ã‡Ã¶zÃ¼m Mimarisi
**Ã‡Ã¶zÃ¼len Problem: LLM HalÃ¼sinasyonu**

**Projemiz, LLM'e cevap vermeden Ã¶nce gÃ¼venilir bir kaynaktan (kendi veri setimizden) ilgili bilgiyi bulmasÄ±nÄ± zorunlu kÄ±larak bu problemi ortadan kaldÄ±rÄ±r.**

**https://github.com/NisanIrmakMarangoz**

"""

try:
    with open('README.md', 'w', encoding='utf-8') as f:
        f.write(readme_content_kullanici)
    print("âœ… 'README.md' dosyasÄ± baÅŸarÄ±yla sizin isteÄŸiniz doÄŸrultusunda gÃ¼ncellendi.")
    print("Colab'Ä±n solundaki 'Dosyalar' menÃ¼sÃ¼nden kontrol edebilirsiniz.")

except Exception as e:
    print(f"HATA: README dosyasÄ± gÃ¼ncellenemedi: {e}")

"""bundan sonraki hÃ¼cre, kÄ±lavuz iÃ§indir.

"""

# YENÄ° HÃœCRE: PROJECT_REPORT.md DosyasÄ±nÄ± GÃ¶rsel ReferanslarÄ± ile Yeniden OluÅŸturma

project_report_content_with_images = """
# ğŸš€ FITNESS BÄ°LGÄ° ASÄ°STANI - PROJE RAPORU VE Ã‡ALIÅMA KILAVUZU

Bu rapor, projenin teknik mimarisini, kullanÄ±lan teknolojileri ve canlÄ± web arayÃ¼zÃ¼nÃ¼n nasÄ±l kullanÄ±lacaÄŸÄ±nÄ± detaylandÄ±rmaktadÄ±r.

---

## ğŸ“ BÃ–LÃœM A: Ã‡Ã–ZÃœM MÄ°MARÄ°SÄ° (RAG)

### A.1 Mimarinin Ã‡Ã¶zdÃ¼ÄŸÃ¼ Temel Problem
**Problem:** BÃ¼yÃ¼k Dil Modellerinin (LLM) uydurma (halÃ¼sinasyon) eÄŸilimi ve Ã¶zel/niÅŸ konularda bilgi yetersizliÄŸi.
**RAG Ã‡Ã¶zÃ¼mÃ¼:** LLM (Gemini 2.5 Flash), cevap vermeden Ã¶nce **gÃ¼venilir, Ã¶zel veri setimizden** ilgili bilgiyi (BaÄŸlamÄ±) bulmaya zorlanÄ±r. Bu, doÄŸruluk oranÄ±nÄ± artÄ±rÄ±r ve gÃ¼ncel kalmayÄ± saÄŸlar.

### A.2 KullanÄ±lan Teknolojiler
| Kategori | Teknoloji | RolÃ¼ |
| :--- | :--- | :--- |
| **BÃ¼yÃ¼k Dil Modeli (LLM)** | **Google Gemini 2.5 Flash** | Nihai cevabÄ±, saÄŸlanan baÄŸlama gÃ¶re Ã¼retir. |
| **Orkestrasyon** | **LangChain (LCEL)** | RAG zincirinin adÄ±mlarÄ±nÄ± (Prompt, LLM, Retriever) yÃ¶neten Ã§erÃ§evedir. |
| **VektÃ¶r DB** | **ChromaDB** | Veri parÃ§alarÄ±nÄ±n vektÃ¶r formunda tutulduÄŸu yerel veritabanÄ±. |
| **VektÃ¶rleÅŸtirme** | **Sentence-Transformers** | Metinleri arama yapÄ±labilir sayÄ± dizilerine (VektÃ¶rlere) Ã§evirir. |
| **Web ArayÃ¼zÃ¼** | **Gradio** | Son kullanÄ±cÄ±nÄ±n eriÅŸebileceÄŸi sohbet arayÃ¼zÃ¼nÃ¼ saÄŸlar. |

### A.3 RAG AkÄ±ÅŸ ÅemasÄ±
Proje, her sorguda ÅŸu akÄ±ÅŸÄ± izler:
Soru $\rightarrow$ ChromaDB (Arama) $\rightarrow$ Ä°lgili Veri ParÃ§alarÄ± $\rightarrow$ Prompt Åablonu $\rightarrow$ Gemini $\rightarrow$ Nihai Cevap

---

## ğŸŒ BÃ–LÃœM B: WEB ARAYÃœZÃœ & PRODUCT KILAVUZU (Test ve Kabiliyetler)

Bu bÃ¶lÃ¼m, canlÄ± uygulamanÄ±n nasÄ±l kullanÄ±lacaÄŸÄ±nÄ±, hangi kabiliyetlere sahip olduÄŸunu ve test senaryolarÄ±nÄ± iÃ§erir.

### B.1 Uygulama Linki (Deploy Link)
CanlÄ± uygulamaya eriÅŸim linki aÅŸaÄŸÄ±dadÄ±r. https://b88169486e8cfc1bb8.gradio.live


### B.2 KullanÄ±cÄ± AkÄ±ÅŸÄ± ve Ã‡alÄ±ÅŸma Prensibi

KullanÄ±cÄ±, Gradio arayÃ¼zÃ¼nde sadece soru yazar. Arka planda sistem, sorulan konuya **yalnÄ±zca kendi bilgi havuzunda** arama yaparak cevap bulur.

**ArayÃ¼z GÃ¶rÃ¼nÃ¼mÃ¼ (BoÅŸ BaÅŸlangÄ±Ã§):**
*https://github.com/NisanIrmakMarangoz/images-/blob/main/Bosarayuz.png*

**Ã‡alÄ±ÅŸma AkÄ±ÅŸÄ± Ã–zeti:**
1.  **Girdi:** KullanÄ±cÄ± Fitness, Beslenme veya Programlama sorusu sorar.
2.  **Arama:** RAG sistemi, Ã¶zel veri setimizde en uygun bilgiyi (BaÄŸlamÄ±) bulur.
3.  **Cevap Ãœretme:** Gemini, bu baÄŸlamÄ± kullanarak, dÄ±ÅŸarÄ±dan bilgi eklemeden cevabÄ± Ã¼retir.
4.  **Hata YÃ¶netimi:** Bilgi seti dÄ±ÅŸÄ±nda kalan sorularda, sistem **"Bu konuda veri setimde bilgi bulunmamaktadÄ±r."** uyarÄ±sÄ±yla gÃ¼venilirliÄŸini korur.

### B.3 Projenin Temel Kabiliyetleri ve Test SenaryolarÄ±

Projenin baÅŸarÄ±yla Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± gÃ¶stermek iÃ§in aÅŸaÄŸÄ±daki testleri arayÃ¼zde uygulayÄ±n:

| Kabiliyet AlanÄ± | Test Sorusu | AmacÄ± (KanÄ±tÄ±) |
| :--- | :--- | :--- |
| **Egzersiz UzmanlÄ±ÄŸÄ±** | "Bench Press'te hangi kaslar Ã§alÄ±ÅŸÄ±r?" | Temel veri setindeki spesifik bilgiyi doÄŸru getirdiÄŸini kanÄ±tlar. |
| **GeniÅŸletilmiÅŸ Bilgi (Beslenme)** | "Kreatin takviyesinin faydalarÄ± ve gÃ¼nlÃ¼k dozu nedir?" | Sonradan eklenen ve vektÃ¶rleÅŸtirilen yeni bilgiyi kullanabildiÄŸini test eder. |
| **Programlama KapsamÄ±** | "Push/Pull/Legs sistemi kimler iÃ§in uygundur?" | Antrenman programlama bilgisini sunabildiÄŸini gÃ¶sterir. |

**Ã–rnek BaÅŸarÄ±lÄ± Cevap:**
*https://github.com/NisanIrmakMarangoz/images-/blob/main/basarilicevap1.png*
*https://github.com/NisanIrmakMarangoz/images-/blob/main/basarilicevap2.png*

**HalÃ¼sinasyon Ã–nleme (Hata YÃ¶netimi):**
| Kabiliyet AlanÄ± | Test Sorusu | AmacÄ± (KanÄ±tÄ±) |
| :--- | :--- | :--- |
| **HalÃ¼sinasyon Ã–nleme** | "En popÃ¼ler 5 yoga pozu nedir?" | Sistemin bilmediÄŸi bir alanda **uydurmadÄ±ÄŸÄ±nÄ±** gÃ¶stererek RAG'Ä±n ana faydasÄ±nÄ± kanÄ±tlar. |

**Ã–rnek Hata YÃ¶netimi:**
*https://github.com/NisanIrmakMarangoz/images-/blob/main/hatamesaji.png*


"""

# DosyayÄ± "yazma" modu ('w') ile oluÅŸturur ve iÃ§eriÄŸi yazar.
try:
    with open('PROJECT_REPORT.md', 'w', encoding='utf-8') as f:
        f.write(project_report_content_with_images)
    print("âœ… 'PROJECT_REPORT.md' dosyasÄ±, tÃ¼m mimari, test kÄ±lavuzu ve gÃ¶rsel referanslarÄ± ile baÅŸarÄ±yla gÃ¼ncellendi.")
    print("GitHub'a yÃ¼klemeden Ã¶nce lÃ¼tfen gÃ¶rsel yollarÄ±nÄ± kontrol edin!")

except Exception as e:
    print(f"HATA: Proje raporu dosyasÄ± oluÅŸturulamadÄ±: {e}")